◆コリジョンの処理について

プレイヤーキャラクターは、円柱コリジョンで、
半径 0.4 高さ 1.48

●上下移動の判定について

上方または下方のベクトルを加えて、中心は、

下方 x, y +    0, z
上方 x, y + 1.48, z

半径を加えた、実質 2x2 の範囲のブロックを検査する。

上方または下方ベクトル量が1を超える場合は、1ずつ区切って検査する。
　※突き抜けを防止するため

例
　速すぎる落下　↓2.38
　　１回目の検査 1.0
　　２回目の検査 2.0
　　３回目の検査 2.38

半径を r とした場合、

x0 = x - r
x1 = x + r
z0 = z - r
z1 = z + r

x0, x1, z0, z1 をブロック単位座標に変換し、その範囲で検査する。
ケースとしては、1x1 2x1 1x2 2x2 になる。

判定に使用するポリゴン面は、全て水平想定とする。
高さが近い順にソートし(上方の場合はより下・下方の場合はより上)、
円と四角の接触判定を行う。
※四角は格子に沿っていない事を想定する。

円と回転する四角の接触判定

1)四角の４線分と円の距離(円の中心から線分への垂直線)が半径以上か判定
　　→１つでも半径以上と判定されたら接触していない。
　　　　※外積で、線分の外側で正・線分の内側で負
　　　　　負値で次の線分判定へ
　　　　　正値で半径未満と判定された場合は、
　　　　　その線分で2)の判定を行う。
　　　　

2)接触の可能性があると判定された場合、
　４線分で、内積計算で線分に円の中心からの垂直線を伸ばした接触点までの
　計算基準点(線分)の始点からの距離を求め、線分上にあるか判定する。
　線分上にあると判定されたら、接触決定。
　線分のマイナス方向にあると判定されたら、計算基準点との距離が、
　半径以上の場合は非接触。半径未満の場合は接触と判定。
　線分のプラス方向でオーバーする場合は、
　次の線分の頂点からの距離の判定へ


======================================================
◆接触すると判定された後の押し戻しベクトル

単純に接触するかどうかではなく、平面上の移動後に接触するかどうかの判定をとる場合、
接触した後の押し戻しが必要になる。

考え方としては、




